---


---

<h1 id="移动端图片上传oss优化">移动端图片上传OSS优化</h1>
<h3 id="背景">背景</h3>
<p>目前移动端上传OSS没有文件大小限制<br>
对于用户自己上传的图片，未作有效性检验，存在一定的风险<br>
图片未经压缩处理，浪费流量，增加用户下载的耗时，对用户体验早成影响</p>
<h3 id="影响业务">影响业务</h3>
<ul>
<li>直播间：点击没听懂[直播右下角]提交反馈</li>
<li>直播间：截图笔记</li>
<li>直播间：提交答题直播反馈(包括课前, 课中, 课后)</li>
<li>直播间：提交直播反馈(右侧反馈界面)</li>
<li>答题卡：反馈</li>
<li>意见反馈：上传图片 *</li>
<li>H5协议：母亲节活动页上传图片 *</li>
<li>用户信息：上传头像 *</li>
<li>作业：上传作业 *</li>
</ul>
<h3 id="优化方案">优化方案</h3>
<ol>
<li>增加上传OSS的最大文件限制（全局限制，可通过配置中心下发）</li>
<li>各业务场景可制定具体的图片处理策略：
<ul>
<li>是否需要对图片压缩</li>
<li>允许图片的最大的宽高</li>
<li>允许图片的文件大小</li>
</ul>
</li>
<li>流程图:<br>
<img src="https://github.com/Ryan-Hu/DOC/raw/master/UploadImage.png" alt="enter image description here"></li>
</ol>
<h3 id="业务策略定义">业务策略定义</h3>

<table>
<thead>
<tr>
<th>业务场景</th>
<th>压缩策略</th>
</tr>
</thead>
<tbody>
<tr>
<td>直播间：点击没听懂</td>
<td>不压缩</td>
</tr>
<tr>
<td>直播间：截图笔记</td>
<td>不压缩</td>
</tr>
<tr>
<td>直播间：提交答题反馈</td>
<td>不压缩</td>
</tr>
<tr>
<td>直播间：提交直播反馈</td>
<td>不压缩</td>
</tr>
<tr>
<td>答题卡：反馈</td>
<td>压缩(1920 * 1920)</td>
</tr>
<tr>
<td>意见反馈：上传图片</td>
<td>压缩(1920 * 1920)</td>
</tr>
<tr>
<td>H5协议：母亲节活动页上传图片</td>
<td>压缩(1920 * 1920)</td>
</tr>
<tr>
<td>作业：上传作业</td>
<td>压缩?</td>
</tr>
<tr>
<td>用户信息：上传头像</td>
<td>压缩(256 * 256)</td>
</tr>
<tr>
<td>成长训练营：上传录音</td>
<td>不压缩</td>
</tr>
</tbody>
</table>
